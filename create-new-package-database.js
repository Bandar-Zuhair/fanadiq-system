let existingDataStatus="newData";const scriptURL="https://script.google.com/macros/s/AKfycbwqp6rBvBQOUNttF3vz5Z9mW3x3VOYVv_k7p-lIlsg5p0M_TStsic5jyuxgElqJ2Ye4jA/exec",form=document.forms["save-package"];function cleanHTML(e){return e.replace(/\s+/g," ").trim()}form.addEventListener("submit",e=>{if(e.preventDefault(),"none"!==document.getElementById("downloaded_pdf_clint_data_page").style.display){new Audio("success.mp3").play(),document.getElementById("sumbit_save_new_data_to_sheet_input_button_id").value="جاري الحفظ..",document.getElementById("sumbit_save_new_data_to_sheet_input_button_id").style.background="rgb(85, 127, 137)",document.getElementById("sumbit_save_new_data_to_sheet_input_button_id").style.color="white";let t=document.getElementById("package_user_code_name_for_later_import_reference_p_id").innerText;if("none"===document.getElementById("downloaded_pdf_clint_data_page").style){alert("تأكد من إدخال معلومات العميل");return}let n={name:t,content:{},status:existingDataStatus};["downloaded_pdf_clint_data_page","downloaded_pdf_package_including_data_page","downloaded_pdf_flight_data_page","downloaded_pdf_hotel_data_page","downloaded_pdf_clint_movements_data_page","downloaded_pdf_total_price_data_page"].forEach(e=>{let t=document.getElementById(e);t&&"none"!==t.style.display&&t.offsetWidth>0&&t.offsetHeight>0&&(n.content[e]=cleanHTML(t.innerHTML))}),fetch("https://script.google.com/macros/s/AKfycbwqp6rBvBQOUNttF3vz5Z9mW3x3VOYVv_k7p-lIlsg5p0M_TStsic5jyuxgElqJ2Ye4jA/exec",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json"},mode:"no-cors"}).then(()=>{document.getElementById("sumbit_save_new_data_to_sheet_input_button_id").style.background="rgb(0, 46, 57)",document.getElementById("sumbit_save_new_data_to_sheet_input_button_id").value="تم الحفظ بنجاح",setTimeout(()=>{document.getElementById("sumbit_save_new_data_to_sheet_input_button_id").style.background="white",document.getElementById("sumbit_save_new_data_to_sheet_input_button_id").style.color="black",document.getElementById("sumbit_save_new_data_to_sheet_input_button_id").value="حفظ جديد"},5e3),"newData"===existingDataStatus&&submitForm(),updateDataBaseSavedDataNames(),existingDataStatus="existingData",document.getElementById("website_users_name_input_id").disabled=!0})}else new Audio("error.mp3").play(),document.getElementById("sumbit_save_new_data_to_sheet_input_button_id").style.background="red",document.getElementById("sumbit_save_new_data_to_sheet_input_button_id").style.color="white",setTimeout(()=>{document.getElementById("sumbit_save_new_data_to_sheet_input_button_id").style.background="white",document.getElementById("sumbit_save_new_data_to_sheet_input_button_id").style.color="black"},500),document.getElementById("scroll_bottom_page_icon").style.background="red",document.getElementById("scroll_bottom_page_icon").style.color="white",setTimeout(()=>{document.getElementById("scroll_bottom_page_icon").style.background="rgb(85, 127, 137)",document.getElementById("scroll_bottom_page_icon").style.color="white"},500)}),document.getElementById("use_website_user_code_name_as_downloaded_pdf_file_name_p_id").addEventListener("click",function(){form.dispatchEvent(new Event("submit"))}),document.getElementById("check_pdf_name_button").addEventListener("click",function(){form.dispatchEvent(new Event("submit"))}),document.getElementById("scroll_bottom_page_icon").addEventListener("click",function(){form.dispatchEvent(new Event("submit"))});const sheetURL="https://script.google.com/macros/s/AKfycbyYKdJJLk39czGy6GPO-DDvmWXuyGOPO9cCNOK1ST_dhi--GJSaXW5qiTSXBACtOhWRRA/exec";let sheetData=[];function updateDataBaseSavedDataNames(){let e=document.getElementById("all_google_sheet_stored_data_names_for_importing_data_div");e.innerHTML="";if(localStorage.getItem("lastDownloadWebsiteData")){let t=document.createElement("h3");t.innerText="Last Download",t.onclick=function(){pickThisGoogleSheetDataName(this)},e.appendChild(t)}fetch("https://script.google.com/macros/s/AKfycbyYKdJJLk39czGy6GPO-DDvmWXuyGOPO9cCNOK1ST_dhi--GJSaXW5qiTSXBACtOhWRRA/exec").then(e=>e.json()).then(t=>{(sheetData=t.values).forEach(t=>{let n=document.createElement("h3");n.innerText=t[0],"Name"===n.innerText?n.style.display="none":n.onclick=function(){pickThisGoogleSheetDataName(this)},e.appendChild(n)})}).catch(e=>{})}function findSelectedNameAndImportContent(){let e=null;document.querySelectorAll("#all_google_sheet_stored_data_names_for_importing_data_div h3").forEach(function(t){"rgb(0, 155, 0)"===t.style.backgroundColor&&(e=t.innerText)}),e?"Last Download"===e?importContentFromLocalStorage():"Name"!==e&&(new Audio("success.mp3").play(),importContentForSelectedName(e)):(new Audio("error.mp3").play(),import_google_sheet_data_p_id.style.backgroundColor="red",setTimeout(()=>{import_google_sheet_data_p_id.style.backgroundColor="rgb(255, 174, 0)"},500))}function importContentFromLocalStorage(){let e=localStorage.getItem("lastDownloadWebsiteData");if(e){let t=JSON.parse(e).e;try{let n=new DOMParser;for(let l in t){let o=t[l];if(o){let i=LZString.decompressFromUTF16(o),a=formatHtmlForWebsite(i),d=n.parseFromString(a,"text/html").body.innerHTML,r=document.getElementById(l);r&&(r.style.display="block",r.innerHTML="",r.innerHTML=d,reActiveDragAndDropFunctionality(r.id))}}hideOverlay(),existingDataStatus="existingData",document.getElementById("website_users_name_input_id").disabled=!0;document.querySelectorAll(".inserted_package_data_section_page_image_class").forEach(e=>{e.style.display="none"}),document.getElementById("inserted_company_name_image_position_div").style.display="flex"}catch(s){}}else new Audio("error.mp3").play()}function importContentForSelectedName(e){let t=sheetData.find(t=>t[0]===e);if(t){let n={downloaded_pdf_clint_data_page:t[1],downloaded_pdf_package_including_data_page:t[2],downloaded_pdf_flight_data_page:t[3],downloaded_pdf_hotel_data_page:t[4],downloaded_pdf_clint_movements_data_page:t[5],downloaded_pdf_total_price_data_page:t[6]};try{let l=new DOMParser;for(let o in n){let i=n[o];if(i){let a=formatHtmlForWebsite(i),d=l.parseFromString(a,"text/html").body.innerHTML,r=document.getElementById(o);r&&(r.style.display="block",r.innerHTML="",r.innerHTML=d,reActiveDragAndDropFunctionality(r.id))}}hideOverlay(),existingDataStatus="existingData",document.getElementById("website_users_name_input_id").disabled=!0;document.querySelectorAll(".inserted_package_data_section_page_image_class").forEach(e=>{e.style.display="none"}),document.getElementById("inserted_company_name_image_position_div").style.display="flex"}catch(s){}}}function formatHtmlForWebsite(e){return e.replace(/\s+/g," ").trim()}function pickThisGoogleSheetDataName(e){document.querySelectorAll("#all_google_sheet_stored_data_names_for_importing_data_div h3").forEach(function(e){e.style.backgroundColor="white",e.style.color="black"}),e.style.backgroundColor="rgb(0, 155, 0)",e.style.color="white"}document.getElementById("refresh_import_saved_packages_data_input_value_icon").onclick=function(){let e=document.getElementById("import_google_sheet_data_names_search_bar_input_id"),t=e.value;e.value="",setTimeout(()=>{e.value=t,updateDataBaseSavedDataNames()},500)};let mostTopEmptyCellRowNumberValue;async function submitForm(){let e=document.getElementById("save-package-unique-code"),t=document.getElementById("website_users_name_input_id"),n=t.value;if(n)try{await fetch(e.action,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,action:"insert"}),mode:"no-cors"})}catch(l){}}async function fetchData(){try{let e=await fetch("https://script.google.com/macros/s/AKfycbzzOPqv4b5wrZ3tVrk26fr3OeofPi1Y0CRi4TYu8YQwNm52du6P6xMnBt9azLPqu2vY/exec"),t=await e.json();processSheetData(t)}catch(n){}}function processSheetData(e){let t=document.getElementById("website_users_name_input_id"),n=t.value;if(!n){alert("Please enter a package name.");return}let l=getColumnIndex(n);if(-1===l){alert("Invalid package name.");return}let o=e.values,i=-1;for(let a=1;a<o.length;a++)if(""===o[a][l]){i=a;break}-1===i&&(i=o.length),mostTopEmptyCellRowNumberValue=i;let d=document.getElementById("clint_inputs_submit_icon");d.style.opacity="1",d.style.pointerEvents="auto",d.disabled=!1}function getColumnIndex(e){switch(e){case"بكج مستر سامي":return 0;case"بكج عبد الله":return 1;case"بكج معتز":return 2;case"بكج وائل":return 3;case"بكج عبد الرحمن":return 4;case"بكج علي":return 5;case"بكج مستر ابو سما":return 6;case"بكج بندر للتجربة":return 7;default:return -1}}reActiveDragAndDropFunctionality=function(e){if("downloaded_pdf_clint_data_page"===e)document.getElementById("package_clint_name_input_id").value=document.getElementById("store_google_sheet_clint_name_value").innerText,document.getElementById("adult_package_person_amount_input_id").value=document.getElementById("store_google_sheet_package_adult_amount_value").innerText,document.getElementById("kids_package_person_amount_input_id").value=document.getElementById("store_google_sheet_package_kids_amount_value").innerText,document.getElementById("whole_package_start_date_input_id").value=document.getElementById("store_google_sheet_whole_package_first_date_value").innerText,document.getElementById("whole_package_end_date_input_id").value=document.getElementById("store_google_sheet_whole_package_last_date_value").innerText,document.getElementById("package_total_nights_input_id").value=document.getElementById("store_google_sheet_whole_package_total_nights_value").innerText,storePackageTotalNights=document.getElementById("store_google_sheet_whole_package_total_nights_value").innerText,document.getElementById("clint_company_name_input_id").value=document.getElementById("store_google_sheet_clint_company_name_value").innerText,document.getElementById("store_google_sheet_package_user_name_value")?document.getElementById("website_users_name_input_id").value=document.getElementById("store_google_sheet_package_user_name_value").innerText:document.getElementById("website_users_name_input_id").value="عبد الرحمن","بكج شهل عسل"===document.getElementById("store_google_sheet_clint_package_type_checkbox_value").innerText?(document.getElementById("honeymoon_checkbox").checked=!0,document.getElementById("guys_checkbox").checked=!1,document.getElementById("family_checkbox").checked=!1,document.getElementById("two_people_checkbox").checked=!1):"بكج شباب"===document.getElementById("store_google_sheet_clint_package_type_checkbox_value").innerText?(document.getElementById("honeymoon_checkbox").checked=!1,document.getElementById("guys_checkbox").checked=!0,document.getElementById("family_checkbox").checked=!1,document.getElementById("two_people_checkbox").checked=!1):"بكج عائلة"===document.getElementById("store_google_sheet_clint_package_type_checkbox_value").innerText?(document.getElementById("honeymoon_checkbox").checked=!1,document.getElementById("guys_checkbox").checked=!1,document.getElementById("family_checkbox").checked=!0,document.getElementById("two_people_checkbox").checked=!1):"بكج شخصين"===document.getElementById("store_google_sheet_clint_package_type_checkbox_value").innerText?(document.getElementById("honeymoon_checkbox").checked=!1,document.getElementById("guys_checkbox").checked=!1,document.getElementById("family_checkbox").checked=!1,document.getElementById("two_people_checkbox").checked=!0):(document.getElementById("honeymoon_checkbox").checked=!1,document.getElementById("guys_checkbox").checked=!1,document.getElementById("family_checkbox").checked=!1,document.getElementById("two_people_checkbox").checked=!1),document.getElementById("inserted_company_name_logo_id")&&(document.getElementById("inserted_company_name_logo_id").onclick=function(e){e.preventDefault(),e.stopPropagation();let t=document.createElement("div");t.className="black_overlay",t.id="black_overlay_id",document.body.appendChild(t),setTimeout(()=>{t.style.opacity="1"},100);let n=document.getElementById("ensure_delete_company_logo_div");setTimeout(()=>{n.style.transform="translate(-50%, -50%)"},50),t.onclick=()=>{n.style.transform="translate(-50%, -100vh)",t.style.opacity="0",setTimeout(()=>{document.body.removeChild(t)},300)}}),deleteClickedCompanyLogo=function(){document.getElementById("inserted_company_name_image_position_div").innerHTML="";document.getElementById("ensure_delete_company_logo_div").style.transform="translate(-50%, -100vh)";let e=document.getElementById("black_overlay_id");e.style.opacity="0",setTimeout(()=>{document.body.removeChild(e)},300)},deleteClintPackageDataRow=function(){let e=document.getElementById("ensure_delete_clint_package__including_and_not_icluding_data_div");runDeleteClintPackageDataRow=function(){document.getElementById("downloaded_pdf_clint_data_page").style.display="none",e.style.transform="translate(-50%, -100vh)",t.style.opacity="0",setTimeout(()=>{document.body.contains(t)&&document.body.removeChild(t)},300)};let t=document.querySelector(".black_overlay");if(!t){(t=document.createElement("div")).classList.add("black_overlay"),document.body.appendChild(t),setTimeout(()=>{t.style.opacity="1",e.style.transform="translate(-50%, -50%)"},50);let n=()=>{e.style.transform="translate(-50%, -100vh)",t.style.opacity="0",setTimeout(()=>{document.body.contains(t)&&document.body.removeChild(t)},300)};t.addEventListener("click",n),t.addEventListener("touchstart",n),t.addEventListener("click",e=>{e.stopPropagation()})}};else if("downloaded_pdf_flight_data_page"===e)document.querySelectorAll(".flight_row_class").forEach(e=>{e.querySelectorAll(".flight_row_flight_arrival_time_controller").forEach(function(e){e.onclick=function(t){flightRowAirLineControllerFunction(t,e)}});let t;deleteClickedFlightData=function(e){let t=document.querySelector(".black_overlay"),n=document.getElementById(e);n&&n.remove();document.getElementById("ensure_delete_or_edit_flight_data_div").style.transform="translate(-50%, -100vh)",t.style.opacity="0",setTimeout(()=>{document.body.removeChild(t)},300);0===document.querySelectorAll(".inserted_flight_data_row").length&&(document.getElementById("downloaded_pdf_flight_data_page").style.display="none")},editClickedFlightData=function(e){create_new_clint_data_section.style.display="none",create_new_hotel_package_section.style.display="none",create_new_flight_package_section.style.display="flex",create_new_package_including_and_not_including_data_section.style.display="none",create_new_clint_movements_plan_section.style.display="none",document.getElementById("clint_flight_inputs_submit_icon").style.display="none",document.getElementById("confirm_new_flight_data_row_icon").style.display="block",document.getElementById("cancel_new_flight_data_row_icon").style.display="block",document.getElementById("flight_content_section_title_text_id").innerText="تعديل تفاصيل الطيران",document.getElementById("flight_content_section_title_text_id").style.background="rgb(85, 127, 137)",document.getElementById("flight_data_dropdown_content").scrollIntoView({block:"center",inline:"center",behavior:"smooth"});let n=document.querySelector(".black_overlay");document.getElementById("ensure_delete_or_edit_flight_data_div").style.transform="translate(-50%, -100vh)",n.style.opacity="0",setTimeout(()=>{document.body.removeChild(n)},300),document.getElementById("all_editing_flight_row_data_inputs_div").style.display="flex";let l=document.getElementById(e),o=e.split("_").pop(),i=l.querySelector(`p[id^='flight_air_line_${o}']`)?.innerText||"",a=l.querySelector(`p[id^='flight_adult_person_amount_${o}']`)?.innerText||"",d=l.querySelector(`p[id^='flight_infant_person_amount_${o}']`)?.innerText||"",r=l.querySelector(`h2[id^='flight_from_city_${o}']`)?.innerText||"",s=l.querySelector(`h3[id^='flight_to_city_${o}']`)?.innerText||"",c=l.querySelector(`h1[id^='flight_date_${o}']`)?.innerText||"",y=l.querySelector(`p[id^='flight_fly_away_time_${o}']`)?.innerText||"",g=l.querySelector(`p[id^='flight_arrival_time_${o}']`)?.innerText||"",m=l.querySelector(`p[id^='flight_extra_bags_${o}']`)?.innerText||"";document.getElementById("flight_air_line_input_id").value=i,document.getElementById("flight_adult_person_amount_input_id").value=a,document.getElementById("flight_infant_person_amount_input_id").value=d,document.getElementById("flight_from_city_input_id").value=r,document.getElementById("flight_to_city_input_id").value=s,document.getElementById("flight_date_input_id").value=c,document.getElementById("flight_fly_away_time_input_id").value=y,document.getElementById("flight_arrival_time_input_id").value=g,document.getElementById("flight_extra_bags_input_id").value=m,cancelNewFlightDataRow=function(){document.getElementById("flight_air_line_input_id").value="",document.getElementById("flight_from_city_input_id").value="",document.getElementById("flight_to_city_input_id").value="",document.getElementById("flight_date_input_id").value="",document.getElementById("flight_fly_away_time_input_id").value="",document.getElementById("flight_arrival_time_input_id").value="",document.getElementById("flight_extra_bags_input_id").value="",document.getElementById("clint_flight_inputs_submit_icon").style.display="block",document.getElementById("confirm_new_flight_data_row_icon").style.display="none",document.getElementById("cancel_new_flight_data_row_icon").style.display="none",document.getElementById("flight_content_section_title_text_id").innerText="تفاصيل الطيران",document.getElementById("flight_content_section_title_text_id").style.background="rgb(131, 0, 148)",document.getElementById("all_editing_flight_row_data_inputs_div").style.display="none"},confirmNewFlightDataRow=function(){new Audio("success.mp3").play();let e=document.getElementById(t);e.innerHTML="";let n=document.getElementById("flight_air_line_input_id").value,l=document.getElementById("flight_adult_person_amount_input_id").value,i=document.getElementById("flight_infant_person_amount_input_id").value,a=document.getElementById("flight_from_city_input_id").value,d=document.getElementById("flight_to_city_input_id").value,r=document.getElementById("flight_date_input_id").value,s=document.getElementById("flight_fly_away_time_input_id").value,c=document.getElementById("flight_arrival_time_input_id").value,y=document.getElementById("flight_extra_bags_input_id").value,g=`
                        <div class="flight_row_flight_arrival_time_controller inserted_flight_data_row" style="cursor: pointer;">
                            ${n?`<p id="flight_air_line_${o}">${n}</p>`:""}
                        </div>
                        <div>
                            <p id="flight_adult_person_amount_${o}">${l}</p>
                            ${i?`<p id="flight_infant_person_amount_${o}">${i}</p>`:""}
                        </div>
                        <div>
                            <p>20 كيلو للشخص</p>
                            ${y?`<p id="flight_extra_bags_${o}">${y}</p>`:""}
                        </div>
                        <div>
                            ${a?`<h2 id="flight_from_city_${o}">${a}</h2>`:""}
                        </div>
                        <div>
                            ${d?`<h3 id="flight_to_city_${o}">${d}</h3>`:""}
                        </div>
                        <div>
                            ${r?`<h1 id="flight_date_${o}" class="flight_date_for_matching_whole_package_date">${r}</h1>`:""}
                        </div>
                        <div>
                            ${s?`<p id="flight_fly_away_time_${o}">${s}</p>`:""}
                        </div>
                        <div>
                            ${c?`<p id="flight_arrival_time_${o}">${c}</p>`:""}
                        </div>
                    `;e.innerHTML=g,cancelNewFlightDataRow(),document.querySelectorAll(".flight_row_flight_arrival_time_controller").forEach(function(e){e.onclick=function(t){flightRowAirLineControllerFunction(t,e)}})}},flightRowAirLineControllerFunction=function(e){let n=document.getElementById("ensure_delete_or_edit_flight_data_div"),l=e.target.closest(".flight_row_class");if(l){t=l.id;let o=document.querySelector(".black_overlay");if(!o){(o=document.createElement("div")).classList.add("black_overlay"),document.body.appendChild(o),setTimeout(()=>{o.style.opacity="1",n.style.transform="translate(-50%, -50%)"},50);let i=()=>{n.style.transform="translate(-50%, -100vh)",o.style.opacity="0",setTimeout(()=>{document.body.contains(o)&&document.body.removeChild(o)},300)};o.addEventListener("click",i),o.addEventListener("touchstart",i),o.addEventListener("click",e=>{e.stopPropagation()})}runDeleteClickedFlightDataFunction=function(){deleteClickedFlightData(t)},runEditClickedFlightDataFunction=function(){editClickedFlightData(t),document.getElementById("header_navbar_links_clint_a").style.backgroundColor="rgb(85, 127, 137)",document.getElementById("header_navbar_links_hotel_a").style.backgroundColor="rgb(85, 127, 137)",document.getElementById("header_navbar_links_flight_a").style.backgroundColor="rgb(0, 46, 57)",document.getElementById("header_navbar_links_package_icluding_and_not_including_a").style.backgroundColor="rgb(85, 127, 137)",document.getElementById("header_navbar_links_clint_movements_a").style.backgroundColor="rgb(85, 127, 137)"}}}});else if("downloaded_pdf_hotel_data_page"===e){let t=document.querySelectorAll(".hotel_row_class");document.getElementById("hotel_check_in_input_id").value=document.getElementById("store_google_sheet_hotel_last_stopped_check_out_date_value").innerText,document.getElementById("hotel_check_in_input_id").disabled=!0,t.forEach(e=>{let t=e.querySelectorAll(".hotel_row_image_controller");function n(e){let t,n,l,o=!1,i=!1;e.addEventListener("touchstart",e=>{let a=e.touches[0];t=a.clientX,n=a.clientY,l=new Date().getTime(),o=!1,i=!0}),e.addEventListener("touchmove",()=>{o=!0}),e.addEventListener("touchend",e=>{i=!1}),e.addEventListener("mousedown",e=>{i||(t=e.clientX,n=e.clientY,l=new Date().getTime(),o=!1)}),e.addEventListener("mousemove",()=>{o=!0}),e.addEventListener("mouseup",e=>{o||i||hotelRowImageControllerFunction(e)})}t.forEach(e=>{n(e)});let l;function o(){!function e(){let t=document.querySelectorAll(".hotel_row_class_for_editing");t.forEach((e,t)=>{let n=e.querySelector("h2"),l=e.querySelector("h3");n&&l&&originalHotelDates[t]&&(n.innerText=originalHotelDates[t].h2Date,l.innerText=originalHotelDates[t].h3Date)})}()}deleteClickedHotelData=function(e){let t=document.querySelector(".black_overlay"),n=document.getElementById(e);n&&n.remove();document.getElementById("ensure_delete_or_edit_hotel_data_div").style.transform="translate(-50%, -100vh)",t.style.opacity="0",setTimeout(()=>{document.body.removeChild(t)},300);if(0===document.querySelectorAll(".inserted_hotel_data_row").length)document.getElementById("downloaded_pdf_hotel_data_page").style.display="none",saveOriginalHotelDates(),"none"!==document.getElementById("create_new_clint_data_section").style.display?document.getElementById("hotel_check_in_input_id").value=document.getElementById("whole_package_start_date_input_id").value:document.getElementById("hotel_check_in_input_id").value="";else{let l=document.querySelectorAll(".hotel_row_class_for_editing"),o=l[l.length-1].querySelector("h3"),i=o?o.innerText.trim():"";document.getElementById("hotel_check_in_input_id").value=i,document.getElementById("store_google_sheet_hotel_last_stopped_check_out_date_value").innerText=i}},editClickedHotelDataFunction=function(e){create_new_clint_data_section.style.display="none",create_new_hotel_package_section.style.display="flex",create_new_flight_package_section.style.display="none",create_new_package_including_and_not_including_data_section.style.display="none",create_new_clint_movements_plan_section.style.display="none",document.getElementById("hotel_inputs_submit_icon").style.display="none",document.getElementById("show_or_hide_second_room_inputs_div_icon").style.display="none",document.getElementById("confirm_new_hotel_data_row_icon").style.display="block",document.getElementById("cancel_new_hotel_data_row_icon").style.display="block",document.getElementById("show_or_hide_second_room_inputs_div_icon_2").style.display="block",document.getElementById("hotel_content_section_title_text_id").innerText="تعديل تفاصيل الفندق",document.getElementById("hotel_content_section_title_text_id").style.backgroundColor="rgb(85, 127, 137)",document.getElementById("hotel_data_dropdown_content").scrollIntoView({block:"center",inline:"center",behavior:"smooth"});let t=document.querySelector(".black_overlay");document.getElementById("ensure_delete_or_edit_hotel_data_div").style.transform="translate(-50%, -100vh)",t.style.opacity="0",setTimeout(()=>{document.body.removeChild(t)},300);let o=document.getElementById(e),i=e.split("_").pop(),a=document.getElementById("hotel_check_in_input_id").value;document.getElementById("hotel_check_in_input_id").disabled=!1;let d=o.querySelector(`h1[id^='hotel_name_${i}']`)?.innerText||"",r=o.querySelector(`h2[id^='hotel_check_in_${i}']`)?.innerText||"",s=o.querySelector(`h3[id^='hotel_check_out_${i}']`)?.innerText||"",c=o.querySelector(`h4[id^='hotel_total_nights_${i}']`)?.innerText||"",y=o.querySelector(`span[id^='hotel_room_type_description_${i}']`)?.innerText||"",g=o.querySelector(`span[id^='hotel_pool_span_id_${i}']`)?.innerText||"",m=o.querySelector(`span[id^='hotel_view_span_id_${i}']`)?.innerText||"",u=o.querySelector(`p[id^='hotel_total_unit_${i}']`)?.innerText||"",p=o.querySelector(`span[id^='hotel_breakfast_span_id_${i}']`)?.innerText||"",h=o.querySelector(`span[id^='hotel_special_request_span_id_${i}']`)?.innerText||"",v=o.querySelector(`span[id^='hotel_extra_info_span_id_${i}']`)?.innerText||"";if(o.querySelector(`span[id^='hotel_room_type_description_2_${i}`)){let f=document.querySelectorAll("#hotel_two_room_data_input_divs_container input, #hotel_two_room_data_input_divs_container textarea");document.getElementById("hotel_second_room_data_input_div").style.display="flex",f.forEach(e=>{e.dataset.originalWidth||(e.dataset.originalWidth=e.style.width),e.style.width="100%"});let E=o.querySelector(`span[id^='hotel_room_type_description_2_${i}']`)?.innerText||"",B=o.querySelector(`span[id^='hotel_pool_span_id_2_${i}']`)?.innerText||"",b=o.querySelector(`span[id^='hotel_view_span_id_2_${i}']`)?.innerText||"",I=o.querySelector(`p[id^='hotel_total_unit_2_${i}']`)?.innerText||"",k=o.querySelector(`span[id^='hotel_breakfast_span_id_2_${i}']`)?.innerText||"",w=o.querySelector(`span[id^='hotel_special_request_span_id_2_${i}']`)?.innerText||"",x=o.querySelector(`span[id^='hotel_extra_info_span_id_2_${i}']`)?.innerText||"";document.getElementById("hotel_room_type_description_input_id_2").value=E,document.getElementById("hotel_room_contain_pool_input_id_2").value=B,document.getElementById("hotel_room_view_input_id_2").value=b,document.getElementById("hotel_unit_amount_input_id_2").value=`عدد الوحدات ${I}`,document.getElementById("hotel_breakfast_people_amount_input_id_2").value=k,document.getElementById("hotel_special_room_request_input_id_2").value=w,document.getElementById("hotel_room_extra_info_textarea_id_2").value=x}else{let $=document.querySelectorAll("#hotel_two_room_data_input_divs_container input, #hotel_two_room_data_input_divs_container textarea");document.getElementById("hotel_second_room_data_input_div").style.display="flex",$.forEach(e=>{e.dataset.originalWidth||(e.dataset.originalWidth=e.style.width),e.style.width="100%"})}document.getElementById("hotel_name_input_id").value=d,document.getElementById("hotel_check_in_input_id").value=r,document.getElementById("hotel_check_out_input_id").value=s,document.getElementById("hotel_total_nights_input_id").value=`${c} ليالي`,document.getElementById("hotel_room_type_description_input_id").value=y,document.getElementById("hotel_room_contain_pool_input_id").value=g,document.getElementById("hotel_room_view_input_id").value=m,document.getElementById("hotel_unit_amount_input_id").value=`عدد الوحدات ${u}`,document.getElementById("hotel_breakfast_people_amount_input_id").value=p,document.getElementById("hotel_special_room_request_input_id").value=h,document.getElementById("hotel_room_extra_info_textarea_id").value=v,storeHotelTotalUnitNumber=u,storeHotelTotalNights=c,cancelNewHotelDataRow=function(){let t=document.querySelectorAll(".hotel_row_class_for_editing"),n=t[t.length-1];document.getElementById("hotel_name_input_id").value="",n.id===e?(document.getElementById("hotel_check_in_input_id").value=document.getElementById("hotel_check_out_input_id").value,document.getElementById("store_google_sheet_hotel_last_stopped_check_out_date_value").innerText=document.getElementById("hotel_check_in_input_id").value):(document.getElementById("hotel_check_in_input_id").value=a,document.getElementById("store_google_sheet_hotel_last_stopped_check_out_date_value").innerText=document.getElementById("hotel_check_in_input_id").value),document.getElementById("hotel_check_out_input_id").value="",document.getElementById("hotel_total_nights_input_id").value="",document.getElementById("hotel_room_type_description_input_id").value="",document.getElementById("hotel_room_contain_pool_input_id").value="",document.getElementById("hotel_room_view_input_id").value="",document.getElementById("hotel_special_room_request_input_id").value="",document.getElementById("hotel_room_extra_info_textarea_id").value="",document.getElementById("hotel_room_type_description_input_id_2").value="",document.getElementById("hotel_room_contain_pool_input_id_2").value="",document.getElementById("hotel_room_view_input_id_2").value="",document.getElementById("hotel_special_room_request_input_id_2").value="",document.getElementById("hotel_room_extra_info_textarea_id_2").value="",document.getElementById("hotel_inputs_submit_icon").style.display="block",document.getElementById("show_or_hide_second_room_inputs_div_icon").style.display="block",document.getElementById("confirm_new_hotel_data_row_icon").style.display="none",document.getElementById("cancel_new_hotel_data_row_icon").style.display="none",document.getElementById("show_or_hide_second_room_inputs_div_icon_2").style.display="none",document.getElementById("hotel_content_section_title_text_id").style.background="rgb(131, 0, 148)",document.getElementById("hotel_content_section_title_text_id").innerText="تفاصيل الفندق",saveOriginalHotelDates(),document.getElementById("hotel_check_in_input_id").disabled=!0},confirmNewHotelDataRow=function(){let t=document.getElementById(e);t.innerHTML="";let o=document.getElementById("hotel_name_input_id").value,a=document.getElementById("hotel_check_in_input_id").value,d=document.getElementById("hotel_check_out_input_id").value,r=document.getElementById("hotel_room_type_description_input_id").value,s=document.getElementById("hotel_room_contain_pool_input_id").value,c=document.getElementById("hotel_room_view_input_id").value,y=document.getElementById("hotel_breakfast_people_amount_input_id").value,g=document.getElementById("hotel_room_extra_info_textarea_id").value;if(""===o||""===a||""===d||""===r||""===hotelUnitAmountInput)confirm_new_hotel_data_row_icon.style.backgroundColor="red",setTimeout(()=>{confirm_new_hotel_data_row_icon.style.backgroundColor="rgb(255, 174, 0)"},500);else{let m=o.toLowerCase().replace(/\s+/g,"-"),u="",p="";for(let h of allHotelDataArray)if(h.hotelName===o){u=h.hotelLocation,h.hasOwnProperty("hotelArea")&&(p=h.hotelArea);break}let v=`
                            <div><h1 id='hotel_name_${i}'>${o}</h1></div>
                            <div><h2 id='hotel_check_in_${i}' class="hotel_check_in_date_for_matching_whole_package_date">${a}</h2></div>
                            <div><h3 style="color: red" id='hotel_check_out_${i}'>${d}</h3></div>
                            <div><h4 id='hotel_total_nights_${i}'>${storeHotelTotalNights}</h4></div>
                            <div class="description_cell"><span id='hotel_room_type_description_${i}'>${r}</span></div>
                            <div><p id='hotel_total_unit_${i}'>${storeHotelTotalUnitNumber}</p></div>
                            <div><h5 id='hotel_location_${i}'>${u}</h5>${p?`<br><h6 id='hotel_area_${i}'>${p}</h6>`:""}</p><img src="صور-الفنادق/${m}.jpg" class="hotel_row_image_controller inserted_hotel_data_row" style="cursor: pointer"></div>
                        `;if(t.innerHTML=v,""!==s){let f=document.createElement("span");f.id=`hotel_pool_p_id_${l}`,f.innerText=s,t.querySelector(".description_cell").appendChild(f)}if(""!==c){let E=document.createElement("span");E.id=`hotel_view_p_id_${l}`,E.innerText=c,t.querySelector(".description_cell").appendChild(E)}if(""!==y){let B=document.createElement("span");B.id=`hotel_breakfast_p_id_${l}`,B.innerText=y,t.querySelector(".description_cell").appendChild(B)}if(""!==g){let b=document.createElement("span");b.id=`hotel_room_extra_info_${i}`,b.innerText=g,b.style.background="rgb(85, 127, 137)",b.style.color="white",b.style.padding="0 5px",t.querySelector(".description_cell").appendChild(b)}t.querySelectorAll(".hotel_row_image_controller").forEach(e=>{n(e)}),cancelNewHotelDataRow()}}},hotelRowImageControllerFunction=function(e){let t=document.getElementById("ensure_delete_or_edit_hotel_data_div"),n=e.target.closest(".hotel_row_class");if(n){l=n.id;let o=document.querySelector(".black_overlay");if(!o){(o=document.createElement("div")).classList.add("black_overlay"),document.body.appendChild(o),setTimeout(()=>{o.style.opacity="1",t.style.transform="translate(-50%, -50%)"},50);let i=()=>{t.style.transform="translate(-50%, -100vh)",o.style.opacity="0",setTimeout(()=>{document.body.contains(o)&&document.body.removeChild(o)},300)};o.addEventListener("click",i),o.addEventListener("touchstart",i),o.addEventListener("click",e=>{e.stopPropagation()})}runDeleteClickedHotelDataFunction=function(){deleteClickedHotelData(l)},runEditClickedHotelDataFunction=function(){editClickedHotelDataFunction(l),document.getElementById("header_navbar_links_clint_a").style.backgroundColor="rgb(85, 127, 137)",document.getElementById("header_navbar_links_hotel_a").style.backgroundColor="rgb(0, 46, 57)",document.getElementById("header_navbar_links_flight_a").style.backgroundColor="rgb(85, 127, 137)",document.getElementById("header_navbar_links_package_icluding_and_not_including_a").style.backgroundColor="rgb(85, 127, 137)",document.getElementById("header_navbar_links_clint_movements_a").style.backgroundColor="rgb(85, 127, 137)"}}},function e(){let t=document.getElementById("inserted_hotel_data_position_div");function n(e){if("img"===e.target.tagName.toLowerCase()){e.preventDefault();let t=e.target.closest(".hotel_row_class");t.classList.add("dragging"),t.dataset.startY=e.clientY,document.addEventListener("mousemove",i),document.addEventListener("mouseup",d),document.body.style.touchAction="none",document.body.style.userSelect="none"}}function l(e){let t=e.touches[0];if("img"===t.target.tagName.toLowerCase()){let n=t.target.closest(".hotel_row_class");n.classList.add("dragging"),n.dataset.startY=t.clientY,document.addEventListener("touchmove",a,{passive:!1}),document.addEventListener("touchend",r),document.body.style.touchAction="none",document.body.style.userSelect="none"}}function i(e){let n=document.querySelector(".dragging"),l=parseInt(n.dataset.startY||0),o=e.clientY-l;n.style.transform=`translateY(${o}px)`;let i=Array.from(t.children),a=i.indexOf(n),d=a;for(let r=0;r<i.length;r++){let s=i[r].getBoundingClientRect();if(r!==a&&e.clientY>s.top&&e.clientY<s.bottom){o>0&&e.clientY>s.bottom-20?d=r+1:o<0&&e.clientY<s.top+20&&(d=r);break}}d!==a&&t.insertBefore(n,i[d])}function a(e){e.preventDefault();let n=document.querySelector(".dragging"),l=e.touches[0],o=parseInt(n.dataset.startY||0),i=l.clientY-o;n.style.transform=`translateY(${i}px)`;let a=Array.from(t.children),d=a.indexOf(n),r=d;for(let s=0;s<a.length;s++){let c=a[s].getBoundingClientRect();if(s!==d&&l.clientY>c.top&&l.clientY<c.bottom){i>0&&l.clientY>c.bottom-20?r=s+1:i<0&&l.clientY<c.top+20&&(r=s);break}}r!==d&&t.insertBefore(n,a[r])}function d(e){let t=document.querySelector(".dragging");t&&(t.classList.remove("dragging"),t.style.transform="",t.removeAttribute("data-start-y"),o()),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",d),document.body.style.touchAction="",document.body.style.userSelect=""}function r(e){let t=document.querySelector(".dragging");t&&(t.classList.remove("dragging"),t.style.transform="",t.removeAttribute("data-start-y"),o()),document.removeEventListener("touchmove",a),document.removeEventListener("touchend",r),document.body.style.touchAction="",document.body.style.userSelect=""}document.querySelectorAll(".hotel_row_class").forEach(e=>{e.addEventListener("mousedown",n),e.addEventListener("touchstart",l)})}(),saveOriginalHotelDates()})}else if("downloaded_pdf_clint_movements_data_page"===e){let n=document.querySelectorAll(".clint_movements_row_class_for_editing");document.getElementById("show_and_hide_clint_movement_section_icon").style.display="inline",processClintMovements(),n.forEach(e=>{e.querySelectorAll(".clint_movements_row_controller").forEach(function(e){e.onclick=function(t){clintMovementsRowCityNameControllerFunction(t,e)}}),editClickedClintMovementsData=function(e){create_new_clint_data_section.style.display="none",create_new_hotel_package_section.style.display="none",create_new_flight_package_section.style.display="none",create_new_package_including_and_not_including_data_section.style.display="none",create_new_clint_movements_plan_section.style.display="block",document.getElementById("clint_movements_auto_create_icon").style.display="none",document.getElementById("confirm_new_clint_movements_data_row_icon").style.display="block",document.getElementById("cancel_new_clint_movements_data_row_icon").style.display="block",document.getElementById("clint_movements_content_section_title_text_id").innerText=`تعديل خط سير يوم ${e.querySelector("h1").innerText}`,document.getElementById("clint_movements_content_section_title_text_id").style.background="rgb(85, 127, 137)",document.getElementById("toggle_clint_movements_details_title_div_id").scrollIntoView({block:"center",inline:"center",behavior:"smooth"}),document.getElementById("whole_package_start_date_input_id").disabled=!0,document.getElementById("whole_package_end_date_input_id").disabled=!0;let t=document.querySelector(".black_overlay");document.getElementById("ensure_delete_or_edit_clint_movemnt_data_div").style.transform="translate(-50%, -100vh)",t.style.opacity="0",setTimeout(()=>{document.body.removeChild(t)},300),document.getElementById("clint_movements_whole_day_actions_details_textarea_id").value=e.querySelector("h2").innerText,processClintMovements(),cancelNewClintMovementsDataRow=function(){document.getElementById("clint_movements_whole_day_actions_details_textarea_id").value="",document.getElementById("clint_movements_auto_create_icon").style.display="block",document.getElementById("confirm_new_clint_movements_data_row_icon").style.display="none",document.getElementById("cancel_new_clint_movements_data_row_icon").style.display="none",document.getElementById("clint_movements_content_section_title_text_id").innerText="برنامج تحركات مقترح",document.getElementById("clint_movements_content_section_title_text_id").style.background="rgb(131, 0, 148)",document.getElementById("whole_package_start_date_input_id").disabled=!1,document.getElementById("whole_package_end_date_input_id").disabled=!1,processClintMovements()},confirmNewClintMovementsDataRow=function(){e.querySelector("h2").innerText=document.getElementById("clint_movements_whole_day_actions_details_textarea_id").value;document.querySelectorAll(".clint_movements_row_controller").onclick=function(e){clintMovementsRowCityNameControllerFunction(e)},cancelNewClintMovementsDataRow()}}}),clintMovementsRowCityNameControllerFunction=function(e){let t=document.getElementById("ensure_delete_or_edit_clint_movemnt_data_div"),n=e.target.closest(".clint_movements_row_class_for_editing");runEditClickedClintMovementsDataFunction=function(){editClickedClintMovementsData(n),document.getElementById("header_navbar_links_clint_a").style.backgroundColor="rgb(85, 127, 137)",document.getElementById("header_navbar_links_hotel_a").style.backgroundColor="rgb(85, 127, 137)",document.getElementById("header_navbar_links_flight_a").style.backgroundColor="rgb(85, 127, 137)",document.getElementById("header_navbar_links_package_icluding_and_not_including_a").style.backgroundColor="rgb(85, 127, 137)",document.getElementById("header_navbar_links_clint_movements_a").style.backgroundColor="rgb(0, 46, 57)"};let l=document.querySelector(".black_overlay");if(!l){(l=document.createElement("div")).classList.add("black_overlay"),document.body.appendChild(l),setTimeout(()=>{l.style.opacity="1",t.style.transform="translate(-50%, -50%)"},50);let o=()=>{t.style.transform="translate(-50%, -100vh)",l.style.opacity="0",setTimeout(()=>{document.body.contains(l)&&document.body.removeChild(l)},300)};l.addEventListener("click",o),l.addEventListener("touchstart",o),l.addEventListener("click",e=>{e.stopPropagation()})}}}else"downloaded_pdf_package_including_data_page"===e&&(document.getElementById("sms_card_with_internet_amount_input_id").value=document.getElementById("store_google_sheet_package_including_sms_value").innerText,document.getElementById("inner_flight_tickets_amount_input_id").value=document.getElementById("store_google_sheet_package_including_inner_tickets_value").innerText,document.getElementById("package_details_textarea_id").value=document.getElementById("store_google_sheet_package_details_textarea_value").innerText.replace(/\\n/g,"\n"),document.getElementById("package_totla_price_input_id").value=document.getElementById("store_google_sheet_package_total_price_value").innerText)};
